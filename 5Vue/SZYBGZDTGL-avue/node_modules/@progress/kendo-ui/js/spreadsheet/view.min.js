module.exports=function(e){function t(s){if(i[s])return i[s].exports;var r=i[s]={exports:{},id:s,loaded:!1};return e[s].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var i={};return t.m=e,t.c=i,t.p="",t(0)}({0:function(e,t,i){i(1644),e.exports=i(1644)},3:function(e,t){e.exports=function(){throw Error("define cannot be used indirect")}},20:function(e,t){e.exports=require("../kendo.core")},1027:function(e,t){e.exports=require("../kendo.menu")},1624:function(e,t){e.exports=require("../util/main")},1644:function(e,t,i){var s,r,n;!function(o,define){r=[i(20),i(1027),i(1645),i(1624)],s=o,n="function"==typeof s?s.apply(t,r):s,!(void 0!==n&&(e.exports=n))}(function(){!function(e){function t(e){var t,i=window.getSelection();i.removeAllRanges(),t=document.createRange(),t.selectNodeContents(e),i.addRange(t)}function i(e,t){var i=e.trs[t].children;return i[i.length-2]}function s(e,t){var i=e.trs[t-1],s=e.trs[t].children.length-1;if(i&&s>=0)return i.children[s]}function r(e){return(e.size||1)+"px solid "+(e.color||"#000")}function n(e){return/:\/\//.test(e)||(e="http://"+e),e}function o(t,i,s,o){function a(t){var s,r=i.link;return r||"object"==typeof i.value&&(r=i.value.link),r?(s={textDecoration:"none"},i.color&&(s.color=i.color),i.underline&&(s.textDecoration="underline"),e.dom.element("a",{href:n(r),style:s,target:"_blank"},t?[t]:[])):t}var l,d,h,c,u,p,m,f,g,_,w,b,x=null!=i.value||null!=i.validation&&!i.validation.value||i.background||i.merged||i.comment;if(s||x){if(l={},d=i.background,d&&(h=d,o&&(h=e.parseColor(h).toHSV(),h.v*=.9,h=h.toCssRgba()),h=r({color:h}),l.outline=h),d&&(l.backgroundColor=d),i.color&&(l.color=i.color),i.fontFamily&&(l.fontFamily=i.fontFamily),i.underline&&(l.textDecoration="underline"),i.italic&&(l.fontStyle="italic"),i.textAlign&&(l.textAlign=i.textAlign),i.bold&&(l.fontWeight="bold"),i.fontSize&&(l.fontSize=i.fontSize+"px"),i.wrap===!0?(l.whiteSpace="pre-wrap",l.overflowWrap="break-word",l.wordWrap="break-word"):(l.whiteSpace="pre",l.overflowWrap="normal",l.wordWrap="normal"),l.left=i.left+1+"px",l.top=i.top+1+"px",l.width=i.width-1+"px",l.height=i.height-1+"px",c=i.value,u=typeof c,p=i.format,p||"number"!=u||c==Math.floor(c)||(p="0.##############"),p&&null!=c?(c=e.spreadsheet.formatting.format(c,p),c.__dataType&&(u=c.__dataType)):null!==c&&void 0!==c&&(c=i.html?e.dom.html(c):e.dom.text(c)),!l.textAlign)switch(u){case"number":case"date":case"percent":case"currency":l.textAlign="right";break;case"boolean":l.textAlign="center"}return e.spreadsheet.draw.applyIndent(i,l),m=[v.cell],s&&m.push(s),i.enable===!1&&m.push("k-state-disabled"),i.merged&&m.push("k-spreadsheet-merged-cell"),i.comment&&m.push("k-spreadsheet-has-comment"),f=i.verticalAlign||"bottom",c=f&&c?e.dom.element("div",{className:"k-vertical-align-"+f},[a(c)]):a(c),g=c?[c]:[],_={style:l},w=i.validation,w&&!w.value&&(g.push(e.dom.element("span",{className:"k-dirty"})),m.push("k-dirty-cell"),_.title=w.message),_.className=m.join(" "),b=e.dom.element("div",_,g),t.push(b),b}}function a(t,n,o){var a,l,d,h,c,u,p,m={};if(o.background&&(m.backgroundColor=o.background),o.color&&(m.color=o.color),o.fontFamily&&(m.fontFamily=o.fontFamily),o.underline&&(m.textDecoration="underline"),o.italic&&(m.fontStyle="italic"),o.textAlign&&(m.textAlign=o.textAlign),o.verticalAlign&&(m.verticalAlign="center"===o.verticalAlign?"middle":o.verticalAlign),o.bold&&(m.fontWeight="bold"),o.fontSize&&(m.fontSize=o.fontSize+"px"),o.wrap===!0&&(m.whiteSpace="pre-wrap"),o.borderRight?m.borderRight=r(o.borderRight):o.background&&(m.borderRightColor=o.background),o.borderBottom?m.borderBottom=r(o.borderBottom):o.background&&(m.borderBottomColor=o.background),a=o.value,l=typeof a,d=o.format,d||"number"!=l||a==Math.floor(a)||(d="0.##############"),d&&null!=a&&(a=e.spreadsheet.formatting.format(a,d),a.__dataType&&(l=a.__dataType)),!m.textAlign)switch(l){case"number":case"date":case"percent":case"currency":m.textAlign="right";break;case"boolean":m.textAlign="center"}return h=null,o.enable===!1&&(h="k-state-disabled"),c=t.addCell(n,a,m,h,o.validation),o.borderLeft?(p=i(t,n),u=r(o.borderLeft),p&&u&&(p.attr.style.borderRight=u)):o.background&&(m.borderLeftColor=o.background),o.borderTop?(p=s(t,n),u=r(o.borderTop),p&&u&&(p.attr.style.borderBottom=u)):o.background&&(m.borderTopColor=o.background),c}function l(e,t,i){return e>=t&&e<=i}function d(t){["N","NE","E","SE","S","SW","W","NW"].forEach(function(i){t.push(e.dom.element("div",{className:"k-spreadsheet-drawing-handle "+i,"data-direction":i}))})}var h,c,u,p,m,f,g,v,_,w=e.jQuery,b=e.spreadsheet.CellRef,x=".",C=7,k=20,y="Error",z={view:"k-spreadsheet-view",fixedContainer:"k-spreadsheet-fixed-container",editContainer:"k-spreadsheet-edit-container",scroller:"k-spreadsheet-scroller",viewSize:"k-spreadsheet-view-size",clipboard:"k-spreadsheet-clipboard",cellEditor:"k-spreadsheet-cell-editor",barEditor:"k-spreadsheet-editor",topCorner:"k-spreadsheet-top-corner",filterHeadersWrapper:"k-filter-wrapper",filterRange:"k-filter-range",filterButton:"k-spreadsheet-filter",filterButtonActive:"k-state-active",horizontalResize:"k-horizontal-resize",verticalResize:"k-vertical-resize",icon:"k-icon",iconFilterDefault:"k-i-arrow-60-down",sheetsBar:"k-spreadsheet-sheets-bar",sheetsBarActive:"k-spreadsheet-sheets-bar-active",sheetsBarInactive:"k-spreadsheet-sheets-bar-inactive",cellContextMenu:"k-spreadsheet-cell-context-menu",rowHeaderContextMenu:"k-spreadsheet-row-header-context-menu",colHeaderContextMenu:"k-spreadsheet-col-header-context-menu",drawingContextMenu:"k-spreadsheet-drawing-context-menu"};e.spreadsheet.messages.view={nameBox:"Name Box",errors:{openUnsupported:"Unsupported format. Please select an .xlsx file.",shiftingNonblankCells:"Cannot insert cells due to data loss possibility. Select another insert location or delete the data from the end of your worksheet.",insertColumnWhenRowIsSelected:"Cannot insert column when all columns are selected.",insertRowWhenColumnIsSelected:"Cannot insert row when all rows are selected.",filterRangeContainingMerges:"Cannot create a filter within a range containing merges",sortRangeContainingMerges:"Cannot sort a range containing merges",cantSortMultipleSelection:"Cannot sort multiple selection",cantSortNullRef:"Cannot sort empty selection",cantSortMixedCells:"Cannot sort range containing cells of mixed shapes",validationError:"The value that you entered violates the validation rules set on the cell.",cannotModifyDisabled:"Cannot modify disabled cells.",insertRowBelowLastRow:"Cannot insert row below the last row.",insertColAfterLastCol:"Cannot insert column to the right of the last column."},tabs:{home:"Home",insert:"Insert",data:"Data"}},e.spreadsheet.messages.menus={cut:"Cut",copy:"Copy",paste:"Paste",merge:"Merge",unmerge:"Unmerge","delete":"Delete",hide:"Hide",unhide:"Unhide",bringToFront:"Bring to front",sendToBack:"Send to back"},h=e.Class.extend({init:function(){this.cols=[],this.trs=[],this._height=0,this._width=0},addColumn:function(t){this._width+=t;var i=e.dom.element("col",{style:{width:t+"px"}});i.visible=t>0,this.cols.push(i)},addRow:function(t){var i,s=null;s={style:{height:t+"px"}},this._height+=t,i=e.dom.element("tr",s),i.visible=t>0,this.trs.push(i)},addCell:function(t,i,s,r,n){var o,a,l;return null!==i&&void 0!==i||(i=""),i instanceof e.dom.Node||(i=e.dom.text(i)),o=[i],a={style:s},n&&!n.value&&(o.push(e.dom.element("span",{className:"k-dirty"})),r=(r||"")+(r?" ":"")+"k-dirty-cell",a.title=n.message),r&&(a.className=r),l=e.dom.element("td",a,o),this.trs[t].children.push(l),l},toDomTree:function(t,i,s){this.trs=this.trs.filter(function(e){return e.visible});var r=0;return this.cols=this.cols.filter(function(e,t){return e.visible||(this.trs.forEach(function(e){e.children.splice(t-r,1)}),r++),e.visible},this),e.dom.element("table",{style:{left:t+"px",top:i+"px",height:this._height+"px",width:this._width+"px"},className:s,role:"presentation"},[e.dom.element("colgroup",null,this.cols),e.dom.element("tbody",null,this.trs)])}}),c='<ul class="#=classNames.cellContextMenu#"><li data-action=cut>#: messages.cut #</li><li data-action=copy>#: messages.copy #</li><li data-action=paste>#: messages.paste #</li><li class="k-separator"></li><li data-action=merge>#: messages.merge #</li><li data-action=unmerge>#: messages.unmerge #</li></ul>',u='<ul class="#=classNames.rowHeaderContextMenu#"><li data-action=cut>#: messages.cut #</li><li data-action=copy>#: messages.copy #</li><li data-action=paste>#: messages.paste #</li><li class="k-separator"></li><li data-action="delete-row">#: messages.delete #</li><li data-action="hide-row">#: messages.hide #</li><li data-action="unhide-row">#: messages.unhide #</li></ul>',p='<ul class="#=classNames.colHeaderContextMenu#"><li data-action=cut>#: messages.cut #</li><li data-action=copy>#: messages.copy #</li><li data-action=paste>#: messages.paste #</li><li class="k-separator"></li><li data-action="delete-column">#: messages.delete #</li><li data-action="hide-column">#: messages.hide #</li><li data-action="unhide-column">#: messages.unhide #</li></ul>',m='<ul class="#=classNames.drawingContextMenu#"><li data-action="bring-to-front">#: messages.bringToFront #</li><li data-action="send-to-back">#: messages.sendToBack #</li><li class="k-separator"></li><li data-action="delete-drawing">#: messages.delete #</li></ul>',e.spreadsheet.ContextMenu=e.ui.ContextMenu,f=e.template('<div class="#=classNames.view#"><div class="#=classNames.fixedContainer#"></div><div class="#=classNames.scroller#"><div class="#=classNames.viewSize#"></div></div><div tabindex="0" class="#=classNames.clipboard#" contenteditable=true></div><div class="#=classNames.cellEditor#"></div></div><div class="#=classNames.sheetsBar#"></div>'+c+u+p+m),g=e.Class.extend({init:function(t,i){var s,r=g.classNames;this.element=t,this.options=w.extend(!0,{messages:e.spreadsheet.messages.view},this.options,i),this._chrome(),this._dialogs=[],t.append(f({classNames:r,messages:e.spreadsheet.messages.menus})),this._formulaInput(),this.wrapper=t.find(x+r.view),this.container=t.find(x+r.fixedContainer)[0],this.scroller=t.find(x+r.scroller)[0],this.clipboard=t.find(x+r.clipboard),this.viewSize=w(this.scroller.firstChild),this.tree=new e.dom.Tree(this.container),this.clipboardContents=new e.dom.Tree(this.clipboard[0]),this.editor=new e.spreadsheet.SheetEditor(this),this._sheetsbar(),s={target:t,animation:!1,showOn:"never"},this.cellContextMenu=new e.spreadsheet.ContextMenu(t.find(x+r.cellContextMenu),s),this.colHeaderContextMenu=new e.spreadsheet.ContextMenu(t.find(x+r.colHeaderContextMenu),s),this.rowHeaderContextMenu=new e.spreadsheet.ContextMenu(t.find(x+r.rowHeaderContextMenu),s),this.drawingContextMenu=new e.spreadsheet.ContextMenu(t.find(x+r.drawingContextMenu),s)},enableClipboard:function(e){this.isClipboardDeactivated=!e,e?this.clipboard.attr("contenteditable",e):this.clipboard.removeAttr("contenteditable")},_resize:function(){var t=w(this.formulaBar.element).parents(".k-spreadsheet-action-bar"),i=e._outerHeight,s=this.tabstrip?i(this.tabstrip.element):0,r=t?i(t):0,n=this.sheetsbar?i(this.sheetsbar.element):0;this.wrapper.height(this.element.height()-(s+r+n)),this.tabstrip&&this.tabstrip.quickAccessAdjust()},_chrome:function(){var t,i=w("<div class='k-spreadsheet-action-bar' />").prependTo(this.element),s=w("<div class='k-spreadsheet-name-editor' />").appendTo(i);this.nameEditor=new e.spreadsheet.NameEditor(s,this.options),t=w("<div />").appendTo(i),this.formulaBar=new e.spreadsheet.FormulaBar(t),this.options.toolbar&&this._tabstrip()},_formulaInput:function(){var t=this.element.find(x+g.classNames.cellEditor);this.formulaInput=new e.spreadsheet.FormulaInput(t,{autoScale:!0})},_sheetsbar:function(){if(this.options.sheetsbar){var t=w.extend(!0,{openDialog:this.openDialog.bind(this)},this.options.sheetsbar);this.sheetsbar=new e.spreadsheet.SheetsBar(this.element.find(x+g.classNames.sheetsBar),t)}},_tabstrip:function(){var t,i=this.options.messages.tabs,s=w.extend(!0,{home:!0,insert:!0,data:!0},this.options.toolbar),r=[];this.tabstrip&&(this.tabstrip.destroy(),this.element.children(".k-tabstrip").remove());for(t in s)(s[t]===!0||s[t]instanceof Array)&&r.push({id:t,text:i[t],content:""});this.tabstrip=new e.spreadsheet.TabStrip(w("<div />").prependTo(this.element),{animation:!1,dataTextField:"text",dataContentField:"content",dataSource:r,toolbarOptions:s,view:this}),this.tabstrip.select(0)},_executeCommand:function(e){this._sheet.trigger("commandRequest",e)},workbook:function(e){this._workbook=e,e._view=this,this.nameEditor._workbook=e},sheet:function(e){this._sheet=e},activeCellRectangle:function(){return this.cellRectangle(this._sheet._viewActiveCell())},_rectangle:function(e,t){return e._grid.boundingRectangle(t.toRangeRef())},isColumnResizer:function(e,t,i){return e-=this._sheet._grid._headerWidth,t._grid.columns.frozen||(e+=this.scroller.scrollLeft),i=this._sheet._grid._columns.locate(0,i,function(t){return Math.abs(e-t)<=C/2}),null===i||this._sheet.isHiddenColumn(i)?null:i},isRowResizer:function(e,t,i){return e-=this._sheet._grid._headerHeight,t._grid.rows.frozen||(e+=this.scroller.scrollTop),i=this._sheet._grid._rows.locate(0,i,function(t){return Math.abs(e-t)<=C/2}),null===i||this._sheet.isHiddenRow(i)?null:i},isFilterIcon:function(t,i,s,r){var n=this,o=s._grid,a=o.rows.frozen?0:n.scroller.scrollTop,l=o.columns.frozen?0:n.scroller.scrollLeft;return t-=n._sheet._grid._headerWidth-l,i-=n._sheet._grid._headerHeight-a,e.util.withExit(function(e){n._sheet.forEachFilterHeader(r,function(r){var o=n._rectangle(s,r);s.filterIconRect(o).intersects(t,i)&&e(!0)})})},isAutoFill:function(e,t,i){var s,r=this._sheet.select();return!(r.size>1)&&(e-=this._sheet._grid._headerWidth,t-=this._sheet._grid._headerHeight,i._grid.columns.frozen||(e+=this.scroller.scrollLeft),i._grid.rows.frozen||(t+=this.scroller.scrollTop),s=this._rectangle(i,r),Math.abs(s.right-e)<8&&Math.abs(s.bottom-t)<8)},isEditButton:function(e,t,i){var s,r=this._sheet.activeCellCustomEditor();if(r&&(s=this.activeCellRectangle(),t>=s.top&&t<=s.bottom))return i._editorInLastColumn?e<s.left&&e>=s.left-k:e>s.right&&e<=s.right+k},drawingAt:function(e,t,i){var s,r,n,o,a;for(e-=this._sheet._grid._headerWidth,t-=this._sheet._grid._headerHeight,i._grid.columns.frozen||(e+=this.scroller.scrollLeft),i._grid.rows.frozen||(t+=this.scroller.scrollTop),s=this._sheet,r=this._sheet._drawings,n=r.length;--n>=0;)if(o=r[n],a=s.drawingBoundingBox(o),a.intersects(e,t))return{drawing:o,drx:a.left-e,dry:a.top-t}},objectAt:function(e,t,i){var s,r,n,o,a,l,d,h,c=this._sheet._grid;if(e<0||t<0||e>this.scroller.clientWidth||t>this.scroller.clientHeight)s={type:"outside"};else if(e<c._headerWidth&&t<c._headerHeight)s={type:"topcorner"};else if(r=this.paneAt(e,t)){if(!i&&(n=this.drawingAt(e,t,r)))return{type:"drawing",drawing:n.drawing,drx:n.drx,dry:n.dry,pane:r,startX:e,startY:t};o=r._grid.rows.indexVisible(t,this.scroller.scrollTop),a=r._grid.columns.indexVisible(e,this.scroller.scrollLeft),l="cell",d=new b(o,a),h=this._sheet.selectionInProgress(),this.isAutoFill(e,t,r)?l="autofill":this.isFilterIcon(e,t,r,d)?l="filtericon":!h&&e<c._headerWidth?(l="rowheader",null!==(o=this.isRowResizer(t,r,o))&&(d=new b(o,(-(1/0))),l="rowresizehandle")):!h&&t<c._headerHeight?(l="columnheader",null!==(a=this.isColumnResizer(e,r,a))&&(d=new b((-(1/0)),a),l="columnresizehandle")):this.isEditButton(e,t,r)&&(l="editor"),s={type:l,ref:d}}else s={type:"outside"};return s.pane=r,s.x=e,s.y=t,s},paneAt:function(e,t){return this.panes.filter(function(i){var s=i._grid;return l(t,s.top,s.bottom)&&l(e,s.left,s.right)})[0]},containingPane:function(e){return this.panes.filter(function(t){return!!t._grid.contains(e)})[0]},cellRectangle:function(e){var t=this.containingPane(e)._grid,i=this._sheet._grid.rectangle(e);return i.offset(t.headerWidth-(t.columns.frozen?0:this.scroller.scrollLeft),t.headerHeight-(t.rows.frozen?0:this.scroller.scrollTop))},refresh:function(e){var t,i,s=this._sheet;this.tabstrip&&this.tabstrip.refreshTools(s.range(s.activeCell())),e.sheetSelection&&this.sheetsbar&&this.sheetsbar.renderSheets(this._workbook.sheets(),this._workbook.sheetIndex(this._sheet)),this._resize(),this.viewSize[0].style.height=s._grid.totalHeight()+"px",this.viewSize[0].style.width=s._grid.totalWidth()+"px",e.layout&&(t=s.frozenColumns(),i=s.frozenRows(),this.panes=[this._pane(i,t)],t>0&&this.panes.push(this._pane(i,0,null,t)),i>0&&this.panes.push(this._pane(0,t,i,null)),i>0&&t>0&&this.panes.push(this._pane(0,0,i,t))),e.filter&&this._destroyFilterMenu(),e.activeCell&&(this._focus=s.activeCell().toRangeRef())},createFilterMenu:function(t){var i,s,r,n,o,a;return this._destroyFilterMenu(),i=this._sheet,s=i.filter().ref,r=new e.spreadsheet.Range(s,i),n=w("<div />").appendTo(this.element),o={column:t,range:r},a=new e.spreadsheet.FilterMenu(n,o),this._filterMenu=a,a},selectClipboardContents:function(){this.isClipboardDeactivated||(this.clipboard.focus(),t(this.clipboard[0]))},scrollIntoView:function(e){var t=!1,i=this.containingPane(e)._grid,s=i.scrollBoundaries(e),r=this.scroller,n=i.rows.frozen?0:r.scrollTop,o=i.columns.frozen?0:r.scrollLeft;return s.top<n&&(t=!0,r.scrollTop=s.scrollTop),s.bottom>n&&(t=!0,r.scrollTop=s.scrollBottom),s.left<o&&(t=!0,r.scrollLeft=s.scrollLeft),s.right>o&&(t=!0,r.scrollLeft=s.scrollRight),t},_destroyDialog:function(){this._dialogs.pop()},openCustomEditor:function(){var e=this,t=e._sheet.activeCell().first(),i=e._sheet.activeCellCustomEditor(),s=e._sheet.range(t);i.edit({range:s,rect:e.activeCellRectangle(),view:this,validation:this._sheet.validation(t),callback:function(t,i){e._executeCommand({command:"EditCommand",options:{operatingRange:s,editRange:s,property:i?"input":"value",value:t}})}})},openDialog:function(t,i){var s=this._sheet;return s.withCultureDecimals(function(){var r,n,o=e.spreadsheet.dialogs.create(t,i);if(o)return o.bind("action",this._executeCommand.bind(this)),o.bind("deactivate",this._destroyDialog.bind(this)),this._dialogs.push(o),r=s.activeCell(),n=new e.spreadsheet.Range(r,s),o.open(n),o}.bind(this))},showError:function(t,i){var s,r,n,o=this._dialogs,a=this.options.messages.errors,l=!1;o.length>0&&o.forEach(function(e){e.options&&e.options.title===y&&(l=!0)}),l||(s=function(t){var i=t.sender.dialog().element;i.find(".k-button:first").focus(),i.find(".k-button, input").on("keydown",function(i){i.keyCode==e.keys.ESC&&t.sender.close()})},r=function(e){var t=e.sender;this.selectClipboardContents(),t._retry&&i&&i()}.bind(this),e.spreadsheet.dialogs.registered(t.type)?(n={close:r},"validationError"===t.type&&(n=w.extend(n,{title:t.title||"Error",text:t.body?t.body:a[t.type],activate:s})),this.openDialog(t.type,n)):this.openDialog("message",{title:t.title||"Error",text:t.body?t.body:a[t.type],activate:s,close:r}))},destroy:function(){this._dialogs.forEach(function(e){e.destroy()}),this.cellContextMenu.destroy(),this.rowHeaderContextMenu.destroy(),this.colHeaderContextMenu.destroy(),this.drawingContextMenu.destroy(),this.cellContextMenu=this.rowHeaderContextMenu=this.colHeaderContextMenu=this.drawingContextMenu=null,this.tabstrip&&(this.tabstrip.destroy(),this.tabstrip=null),this._destroyFilterMenu()},_destroyFilterMenu:function(){this._filterMenu&&(this._filterMenu.destroy(),this._filterMenu=void 0,this._filterMenuColumn=void 0)},render:function(t){var i,s,r,n,o,a,l,d,h,c;this.element.is(":visible")&&(i=this._sheet,s=i.focus(),r=e.support.scrollbar(),n=this.wrapper[0].clientWidth-r,o=this.wrapper[0].clientHeight-r,s&&this.scrollIntoView(s)||(a=i.resizingInProgress()?i.resizeHandlePosition().col===-(1/0)?"column":"row":"none",this.wrapper.toggleClass(z.editContainer,this.editor.isActive()).toggleClass(z.horizontalResize,"row"==a).toggleClass(z.verticalResize,"column"==a),l=i._grid,d=[],h={scroller:this.scroller,toplevelElements:d,contentWidth:n,contentHeight:o},this.panes.forEach(function(e){d.push(e.render(h))}),c=e.dom.element("div",{style:{width:l._headerWidth+"px",height:l._headerHeight+"px"},className:g.classNames.topCorner}),d.push(c),i.resizeHandlePosition()&&i.resizeHintPosition()&&d.push(this.renderResizeHint()),this.tree.render(d),w(this.container).css({width:n,height:o}),this.editor.isActive()?this.editor.toggleTooltip(this.activeCellRectangle()):t.resize||t.comment||i.selectionInProgress()||i.resizingInProgress()||i.draggingInProgress()||i.isInEditMode()||this.renderClipboardContents()))},renderResizeHint:function(){var t,i,s=this._sheet,r=s.resizeHandlePosition(),n=r.col!==-(1/0);return t=n?{height:this.scroller.clientHeight+"px",width:C+"px",left:s.resizeHintPosition().x+"px",top:"0px"}:{height:C+"px",width:this.scroller.clientWidth+"px",top:s.resizeHintPosition().y+"px",left:"0px"},i=_.classNames,e.dom.element("div",{className:i.resizeHint+(n?"":" "+i.resizeHintVertical),style:t},[e.dom.element("div",{className:i.resizeHintHandle}),e.dom.element("div",{className:i.resizeHintMarker})])},renderClipboardContents:function(){var t,i,s,r,n,o=this._sheet,l=o._grid,d=l.normalize(o.select().toRangeRef()),c=this._workbook.clipboard().canCopy();return c.canCopy===!1&&c.multiSelection?(this.clipboardContents.render([]),void this.selectClipboardContents()):(d=o.trim(d),t=new h,i=l.rangeDimensions(d),i.rows.forEach(function(e){t.addRow(e)}),i.columns.forEach(function(e){t.addColumn(e)}),s=o._getMergedCells(d),r=s.primary,n=s.secondary,o.forEach(d,function(e,i,s){var o,l,h=new b(e,i).print();n[h]||(o=a(t,e-d.topLeft.row,s),l=r[h],l&&(o.attr.colspan=l.width(),o.attr.rowspan=l.height()))}),e.support.browser.msie&&this.clipboard.empty(),this.clipboardContents.render([t.toDomTree(0,0,"kendo-clipboard-"+this._workbook.clipboard()._uid)]),void this.selectClipboardContents())},_pane:function(e,t,i,s){var r=new _(this._sheet,this._sheet._grid.pane({row:e,column:t,rowCount:i,columnCount:s}));return r.refresh(this.scroller.clientWidth,this.scroller.clientHeight),r}}),v={cell:"k-spreadsheet-cell",vaxis:"k-spreadsheet-vaxis",haxis:"k-spreadsheet-haxis",vborder:"k-spreadsheet-vborder",hborder:"k-spreadsheet-hborder",rowHeader:"k-spreadsheet-row-header",columnHeader:"k-spreadsheet-column-header",pane:"k-spreadsheet-pane",data:"k-spreadsheet-data",mergedCell:"k-spreadsheet-merged-cell",mergedCellsWrapper:"k-merged-cells-wrapper",activeCell:"k-spreadsheet-active-cell",selection:"k-spreadsheet-selection",selectionWrapper:"k-selection-wrapper",autoFillWrapper:"k-auto-fill-wrapper",single:"k-single",top:"k-top",right:"k-right",bottom:"k-bottom",left:"k-left",resizeHandle:"k-resize-handle",columnResizeHandle:"k-column-resize-handle",rowResizeHandle:"k-row-resize-handle",resizeHint:"k-resize-hint",resizeHintHandle:"k-resize-hint-handle",resizeHintMarker:"k-resize-hint-marker",resizeHintVertical:"k-resize-hint-vertical",selectionHighlight:"k-spreadsheet-selection-highlight",series:["k-series-a","k-series-b","k-series-c","k-series-d","k-series-e","k-series-f"]},_=e.Class.extend({init:function(e,t){this._sheet=e,this._grid=t},refresh:function(e,t){this._grid.refresh(e,t)},isVisible:function(e,t,i){return this._grid.view(e,t).ref.intersects(i)},render:function(t){var i,s,r,n,o,a,l,d,h,c=t.scroller,u=c.scrollLeft,p=c.scrollTop;return p<0&&(p=0),u<0&&(u=0),i=_.classNames,s=this._sheet,r=this._grid,n=r.view(u,p),this._currentView=n,this._currentRect=this._rectangle(n.ref),this._selectedHeaders=s.selectedHeaders(),o=[],o.push(this.renderData(t)),s._activeDrawing||o.push(this.renderSelection(c)),o.push(this.renderAutoFill()),o.push(this.renderEditorSelection()),o.push(this.renderFilterHeaders()),r.hasRowHeader&&(a=e.dom.element("div",{className:i.rowHeader,style:{width:r.headerWidth+"px",top:n.rowOffset+"px"}}),o.push(a),s.forEach(n.ref.leftColumn(),function(t){if(!s.isHiddenRow(t)){var i=t+1,n=s.rowHeight(t);a.children.push(e.dom.element("div",{className:this.headerClassName(t,"row"),style:{width:r.headerWidth+"px",height:n+"px"}},[e.dom.element("div",{className:"k-vertical-align-center"},[e.dom.text(i+"")])]))}}.bind(this))),r.hasColumnHeader&&(l=e.dom.element("div",{className:i.columnHeader,style:{top:"0px",left:n.columnOffset+"px",width:this._currentRect.width+"px",height:r.headerHeight+"px"}}),o.push(l),d=0,s.forEach(n.ref.topRow(),function(t,i){if(!s.isHiddenColumn(i)){var n=e.spreadsheet.Ref.display(null,1/0,i),o=s.columnWidth(i);l.children.push(e.dom.element("div",{className:this.headerClassName(i,"col"),style:{position:"absolute",left:d+"px",width:o+"px",height:r.headerHeight+"px"}},[e.dom.element("div",{className:"k-vertical-align-center"},[e.dom.text(n+"")])])),d+=o}}.bind(this))),s.resizeHandlePosition()&&(r.hasColumnHeader||r.hasRowHeader)&&(s.resizeHintPosition()||this.renderResizeHandle(o)),h=[i.pane],r.hasColumnHeader&&h.push(i.top),r.hasRowHeader&&h.push(i.left),e.dom.element("div",{style:r.style,className:h.join(" ")},o)},headerClassName:function(e,t){var i,s,r,n=this._selectedHeaders;return"row"===t?(i=n.rows[e],s=n.allRows):(i=n.cols[e],s=n.allCols),r=i||(n.all?"full":s?"partial":"none"),r&&(r="k-selection-"+r),r},renderData:function(t){var i,s,r,n,a=this._sheet,l=this._currentView,d=e.dom.element("div",{className:_.classNames.data,style:{position:"relative",left:l.columnOffset+"px",top:l.rowOffset+"px"}}),h=this._currentRect,c=e.spreadsheet.draw.doLayout(a,l.ref,{forScreen:!0}),u=this._grid,p=a._showGridLines;return p&&(i=null,c.xCoords.forEach(function(t){t!==i&&(i=t,d.children.push(e.dom.element("div",{className:v.vaxis,style:{left:t+"px",height:h.height+"px",borderColor:a.gridLinesColor()}})))}),i=null,c.yCoords.forEach(function(t){t!==i&&(i=t,d.children.push(e.dom.element("div",{className:v.haxis,style:{top:t+"px",width:h.width+"px",borderColor:a.gridLinesColor()}})))})),s=e.spreadsheet.draw.Borders(),r=a.activeCell().toRangeRef(),n=r.topLeft,c.cells.forEach(function(i){var h,c,m,f,g,v=null,w=i.row+l.ref.topLeft.row,b=i.col+l.ref.topLeft.col;a._activeDrawing?(h=a._activeDrawing.topLeftCell,h&&h.row==w&&h.col==b&&(v="k-spreadsheet-drawing-anchor-cell")):w==n.row&&b==n.col&&(v=[_.classNames.activeCell].concat(this._activeFormulaColor(),this._directionClasses(r)),a.singleCellSelection()&&v.push(_.classNames.single),v=v.join(" ")),s.add(i),o(d.children,i,v,p),i.comment&&a._commentRef&&w==a._commentRef.row&&b==a._commentRef.col&&(c=4,m=i.right+u.left+l.columnOffset+c,f={top:i.top+u.top+l.rowOffset+"px"},m+200>t.contentWidth?f.right=t.contentWidth-u.left-i.left-l.columnOffset+c+"px":f.left=m+"px",g=e.dom.element("div",{className:"k-tooltip k-spreadsheet-cell-comment",style:f},[e.dom.text(i.comment)]),t.toplevelElements.push(g))},this),s.vert.forEach(function(t){t.forEach(function(t){if(!t.rendered){t.rendered=!0;var i={left:t.x+"px",top:t.top+"px",height:t.bottom-t.top+1+"px",borderWidth:t.size+"px",borderColor:t.color};1!=t.size&&(i.transform="translateX(-"+(t.size-1)/2+"px)"),d.children.push(e.dom.element("div",{className:v.vborder,style:i}))}})}),s.horiz.forEach(function(t){t.forEach(function(t){if(!t.rendered){t.rendered=!0;var i={top:t.y+"px",left:t.left+"px",width:t.right-t.left+"px",borderWidth:t.size+"px",borderColor:t.color};1!=t.size&&(i.transform="translateY(-"+(t.size-1)/2+"px)"),d.children.push(e.dom.element("div",{className:v.hborder,style:i}))}})}),this.renderDrawings(c,d.children),d},renderDrawings:function(t,i){var s=this._sheet,r=s._workbook;t.drawings.forEach(function(t){var n=t.drawing,o=t.box,a=o.toDiv("k-spreadsheet-drawing");n.image&&a.children.push(e.dom.element("div",{className:"k-spreadsheet-drawing-image",style:{backgroundImage:"url('"+r.imageUrl(n.image)+"')",opacity:n.opacity}})),n===s._activeDrawing&&(a.attr.className+=" k-spreadsheet-active-drawing",d(a.children)),i.push(a)})},renderResizeHandle:function(t){var i,s=this._sheet,r=s.resizeHandlePosition(),n=this._rectangle(r),o=[_.classNames.resizeHandle];if(r.col!==-(1/0)){if(this._grid.rows._start>0)return;i={height:this._grid.headerHeight+"px",width:C+"px",left:n.right-C/2+"px",top:"0px"},o.push(z.horizontalResize)}else{if(this._grid.columns._start>0)return;i={height:C+"px",width:this._grid.headerWidth+"px",top:n.bottom-C/2+"px",left:"0px"},o.push(z.verticalResize)}t.push(e.dom.element("div",{className:o.join(" "),style:i}))},filterIconRect:function(t){var i=16,s=3;return new e.spreadsheet.Rectangle(t.right-i-s,t.top+s,i,i)},renderFilterHeaders:function(){function t(t){return e.dom.element("span",{className:n.icon+" "+t})}function i(i,s,r){var n,a={left:s.left+"px",top:s.top+"px"},l=o&&o.columns.some(function(e){return e.index===r}),d=i.filterButton;return l&&(d+=" "+i.filterButtonActive),n=e.dom.element("span",{className:d,style:a},[t(i.iconFilterDefault)])}var s=this._sheet,r=[],n=g.classNames,o=s.filter();return o&&this._addDiv(r,o.ref,n.filterRange),s.forEachFilterHeader(this._currentView.ref,function(e){var t=this._rectangle(e),s=this.filterIconRect(t),o=this._sheet.filterColumn(e),a=i(n,s,o);r.push(a)}.bind(this)),e.dom.element("div",{className:n.filterHeadersWrapper},r)},renderEditorSelection:function(){var t=_.classNames,i=this._sheet,s=[];return i._formulaSelections.forEach(function(i){var r=i.ref;r!==e.spreadsheet.NULLREF&&this._addDiv(s,r,t.selectionHighlight+" "+i.colorClass)}.bind(this)),e.dom.element("div",{className:t.selectionWrapper},s)},renderSelection:function(t){var i=_.classNames,s=[],r=[i.selection],n=this._sheet,o=n.activeCell().toRangeRef(),a=n.select();return r=r.concat(this._activeFormulaColor()),1===a.size()&&r.push("k-single-selection"),this._sheet.autoFillPunch()&&r.push("k-dim-auto-fill-handle"),a.forEach(function(t){t!==e.spreadsheet.NULLREF&&this._addDiv(s,t,r.join(" "))}.bind(this)),this._renderCustomEditorButton(s,o,t),e.dom.element("div",{className:i.selectionWrapper},s)},renderAutoFill:function(){var t,i,s,r,n,o,a,l=[];if(this._sheet.autoFillInProgress())if(t=this._sheet.autoFillRef(),i=this._sheet.autoFillPunch(),s=this._sheet._autoFillDirection,this._addDiv(l,t,"k-auto-fill"),i)this._addDiv(l,i,"k-auto-fill-punch");else if(void 0!==s){switch(s){case 0:r=t.bottomRight,n="k-auto-fill-br-hint";break;case 1:r=t.bottomRight,n="k-auto-fill-br-hint";break;case 2:r=new b(t.topLeft.row,t.bottomRight.col),n="k-auto-fill-tr-hint";break;case 3:r=new b(t.bottomRight.row,t.topLeft.col),n="k-auto-fill-bl-hint"}o=this._addDiv(l,r,n),o&&(a=e.dom.element("span",{className:"k-tooltip"},[e.dom.text(this._sheet._autoFillHint)]),o.children.push(a))}return e.dom.element("div",{className:_.classNames.autoFillWrapper},l)},_addDiv:function(e,t,i){var s,r=this._currentView;return r.ref.intersects(t)&&(s=this._rectangle(t).resize(1,1).toDiv(i),e.push(s)),s},_renderCustomEditorButton:function(t,i,s){var r,n=this,o=n._sheet,a=n._currentView,l=n._grid.columns._axis._count,d=o.activeCellCustomEditor();d&&a.ref.intersects(i)&&(r=n._rectangle(i),o.forEach(i.collapse(),function(i,o,a){var h,c,u;a.left=r.left,a.top=r.top,a.width=r.width,a.height=r.height,h="k-button k-spreadsheet-editor-button",c=o==l-1||n._buttonOutOfVisiblePane(i,o,s),c&&(h+=" k-spreadsheet-last-column"),n._editorInLastColumn=c,u=e.dom.element("div",{className:h,style:{left:a.left+(c?0:a.width)+"px",top:a.top+"px",height:a.height+"px"}}),d.icon&&u.children.push(e.dom.element("span",{className:"k-icon "+d.icon})),t.push(u)}))},_activeFormulaColor:function(){var e,t=[];return this._sheet.isInEditMode()&&(e=this._sheet._formulaSelections.filter(function(e){return e.active&&"ref"==e.type})[0],e&&t.push(e.colorClass)),t},_directionClasses:function(e){var t=[],i=_.classNames,s=this._currentView.ref;return e.move(0,-1).intersects(s)||t.push(i.left),e.move(-1,0).intersects(s)||t.push(i.top),e.move(0,1).intersects(s)||t.push(i.right),e.move(1,0).intersects(s)||t.push(i.bottom),t},_rectangle:function(e){return this._grid.boundingRectangle(e.toRangeRef()).offset(-this._currentView.mergedCellLeft,-this._currentView.mergedCellTop)},_buttonOutOfVisiblePane:function(e,t,i){var s=this,r=s._grid,n=s._sheet,o=n.range(e,t)._ref,a=r.scrollBoundaries(o),l=r.columns.frozen?0:i.scrollLeft;if(a.right+k>l||t+1===n.frozenColumns())return!0}}),e.spreadsheet.View=g,
e.spreadsheet.Pane=_,e.spreadsheet.drawCell=o,w.extend(!0,g,{classNames:z}),w.extend(!0,_,{classNames:v})}(window.kendo)},i(3))},1645:function(e,t){e.exports=require("./sheetsbar")}});