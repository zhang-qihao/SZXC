{"remainingRequest":"C:\\Users\\10415\\Desktop\\0工程\\5Vue\\SZYBGZDTGL-avue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\10415\\Desktop\\0工程\\5Vue\\SZYBGZDTGL-avue\\src\\page\\login\\index-1.vue?vue&type=style&index=0&id=56116969&lang=scss&scoped=true&","dependencies":[{"path":"C:\\Users\\10415\\Desktop\\0工程\\5Vue\\SZYBGZDTGL-avue\\src\\page\\login\\index-1.vue","mtime":1658910909324},{"path":"C:\\Users\\10415\\Desktop\\0工程\\5Vue\\SZYBGZDTGL-avue\\node_modules\\css-loader\\index.js","mtime":499162500000},{"path":"C:\\Users\\10415\\Desktop\\0工程\\5Vue\\SZYBGZDTGL-avue\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"C:\\Users\\10415\\Desktop\\0工程\\5Vue\\SZYBGZDTGL-avue\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"C:\\Users\\10415\\Desktop\\0工程\\5Vue\\SZYBGZDTGL-avue\\node_modules\\sass-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\10415\\Desktop\\0工程\\5Vue\\SZYBGZDTGL-avue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\10415\\Desktop\\0工程\\5Vue\\SZYBGZDTGL-avue\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\n::v-deep .register-dialog .el-dialog__header {\r\n  height: 66px;\r\n  padding: 10px 24px;\r\n}\r\n\r\n::v-deep .el-select {\r\n  height: 100%;\r\n\r\n  .el-input {\r\n    height: 100%;\r\n\r\n    .el-input__inner {\r\n      height: 100%;\r\n      font-size: 16px;\r\n    }\r\n  }\r\n}\r\n\r\n",{"version":3,"sources":["index-1.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6zBA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA","file":"index-1.vue","sourceRoot":"src/page/login","sourcesContent":["<template>\r\n  <div class=\"login-box\">\r\n    <div class=\"login-title\">\r\n      {{ topTitle }}\r\n    </div>\r\n    <div class=\"login-content\">\r\n      <div class=\"login-content-title\">欢迎登录</div>\r\n      <el-form class=\"login-form\"\r\n               status-icon\r\n               :rules=\"loginRules\"\r\n               ref=\"loginForm\"\r\n               :model=\"loginForm\"\r\n               label-width=\"0\">\r\n        <el-form-item prop=\"username\">\r\n          <el-input size=\"small\"\r\n                    v-model=\"loginForm.username\"\r\n                    auto-complete=\"off\"\r\n                    placeholder=\"请输入您的用户名\"\r\n                    @blur=\"checkUserName()\">\r\n          </el-input><!--@keyup.enter.native=\"handleLogin\"-->\r\n        </el-form-item>\r\n        <el-form-item prop=\"password\">\r\n          <el-input size=\"small\"\r\n                    :type=\"passwordType\"\r\n                    v-model=\"loginForm.password\"\r\n                    auto-complete=\"off\"\r\n                    placeholder=\"请输入您的密码\">\r\n            <i class=\"el-icon-view el-input__icon\"\r\n               slot=\"suffix\"\r\n               @click=\"showPassword\"></i>\r\n          </el-input>\r\n        </el-form-item>\r\n        <el-form-item prop=\"code\">\r\n          <el-row :span=\"24\">\r\n            <el-col :span=\"16\">\r\n              <el-input size=\"small\"\r\n                        :maxlength=\"code.len\"\r\n                        v-model=\"loginForm.code\"\r\n                        auto-complete=\"off\"\r\n                        placeholder=\"请输入验证码\">\r\n              </el-input>\r\n            </el-col>\r\n            <el-col :span=\"5\">\r\n              <div class=\"login-code\">\r\n            <span class=\"login-code-img\"\r\n                  v-if=\"code.type == 'text'\">{{ code.value }}</span>\r\n              </div>\r\n            </el-col>\r\n            <el-col :span=\"3\" style=\"display: flex;align-items: center;justify-content: center\">\r\n              <i style=\"font-size: 25px;cursor: pointer;color: #bbb\" @click=\"refreshCode\" class=\"el-icon-refresh\"></i>\r\n            </el-col>\r\n          </el-row>\r\n        </el-form-item>\r\n        <el-form-item prop=\"fixmedins_id\" v-show=\"isAdmin\">\r\n          <el-select v-model=\"loginForm.fixmedins_id\"\r\n                     placeholder=\"请选择机构\"\r\n                     @change=\"changeFixmedins()\" filterable>\r\n            <el-option\r\n                v-for=\"item in fixmedinsList\"\r\n                :key=\"item.code\"\r\n                :label=\"item.name\"\r\n                :value=\"item.code\">\r\n            </el-option>\r\n          </el-select>\r\n        </el-form-item>\r\n        <div class=\"login-submit\">\r\n          <el-button\r\n              v-prevent-re-click\r\n              type=\"primary\"\r\n              size=\"small\"\r\n              @click.native.prevent=\"handleLogin\"\r\n          >安全登录\r\n          </el-button>\r\n        </div>\r\n        <div v-show=\"isNull(loginForm.fixmedins_id) && !isAdmin\" style=\"width: 350px;display: flex;margin:10px auto 0\">\r\n          <div\r\n              style=\"width:70%;color: #ffffff;text-align: left;font-weight: 400;display: inline-block;font-size:14px;cursor: pointer;text-decoration:underline\"\r\n              @click=\"showInfo\">\r\n            本电脑还未入驻平台？点此注册\r\n          </div>\r\n          <div\r\n              style=\"width:30%;color: #ffffff;text-align: right;font-weight: 400;display: inline-block;font-size:14px;cursor: pointer;text-decoration:underline\"\r\n              @click=\"linkAnQuan\">\r\n            安全码申请\r\n\r\n          </div>\r\n        </div>\r\n\r\n        <div v-show=\"!isNull(loginForm.fixmedins_id) && !isAdmin\">\r\n          <div\r\n              style=\"margin-top: 10px;width: 100%;justify-content: space-between;color: #ffffff;font-weight: 400;text-align: center;font-size:14px;cursor: pointer;text-decoration:underline\"\r\n              @click=\"linkAnQuan\">\r\n            安全码申请\r\n          </div>\r\n        </div>\r\n\r\n        <!--        <div class=\"login-tool\" style=\"text-align: center;font-size:16px\" @click=\"showInfo\">-->\r\n        <!--          本电脑还未注入平台？点此注册-->\r\n        <!--        </div>-->\r\n      </el-form>\r\n    </div>\r\n    <el-dialog class=\"register-dialog\" :visible.sync=\"dialogVisible\" :close-on-click-modal=\"false\" width=\"450px\"\r\n               :before-close=\"handleClose\" center>\r\n      <div slot=\"title\">\r\n        <div>本电脑使用医保收费系统申请</div>\r\n        <div style=\"text-align: center\">定点医疗机构</div>\r\n      </div>\r\n      <el-container style=\"height: 100%\">\r\n        <el-main style=\"height: 100%;overflow: auto;\">\r\n          <div class=\"main-content\">\r\n            <base-block rounded>\r\n\r\n              <div v-show=\"!registerflag&&(status=='0'||status=='3')\"\r\n                   style=\"margin: 0 -30px 15px;background: #fffce7;color: #fdae17;font-weight: 500;line-height: 18px;word-break: break-all;padding: 8px 60px\">\r\n                <div style=\"display: flex;justify-content: space-between\">\r\n                  <div style=\"flex-shrink: 0;\">审核状态：{{ statusjson[status] }}</div>\r\n                  <div style=\"flex-shrink: 0;\" v-show=\"status!='0'\">审核时间：{{ substring(examinetime, 0, 10) }}</div>\r\n                </div>\r\n                <div style=\"word-break: break-all\" v-show=\"status=='3'\">原因：{{ remark }}</div>\r\n              </div>\r\n\r\n              <div v-show=\"registerflag&&status=='2'\"\r\n                   style=\"margin: 0 -30px 15px;background: #fffce7;color: #fdae17;font-weight: 500;line-height: 18px;word-break: break-all;padding: 8px 60px\">\r\n                <div style=\"display: flex;justify-content: space-between\">\r\n                  <div style=\"flex-shrink: 0;\">审核状态：{{ statusjson[status] }}</div>\r\n                  <div style=\"flex-shrink: 0;\" v-show=\"status!='0'\">审核时间：{{ substring(examinetime, 0, 10) }}</div>\r\n                </div>\r\n              </div>\r\n\r\n              <el-form ref=\"registerform\" :model=\"registerform\" label-position=\"right\" label-width=\"100px\"\r\n                       v-show=\"registerform.fix_flag=='1'\">\r\n                <el-row>\r\n                  <el-col :span=\"24\" style=\"margin-bottom: 5px\">\r\n                    <ef-text label=\"定点机构编码\" name=\"fixmedins_code\" v-model=\"registerform.fixmedins_code\" require=\"true\"\r\n                             :readonly=\"registerflag\" :maxlength=12 :minlength=12 :checkFlag=\"true\"/>\r\n                  </el-col>\r\n                </el-row>\r\n                <el-row>\r\n                  <el-col :span=\"24\">\r\n                    <div v-show=\"!registerflag\"\r\n                         style=\"margin-left: 100px;background: #fffce7;color: #fdae17;font-weight: 500;line-height: 18px;word-break: break-all;padding: 8px 17px\">\r\n                      请填写12位国家医药机构编码（提示：第1位是字母，后11位是数字）\r\n                    </div>\r\n                  </el-col>\r\n                </el-row>\r\n                <el-row>\r\n                  <el-col :span=\"24\" style=\"margin-bottom:5px\">\r\n                    <ef-text label=\"机构名称\" name=\"fixmedins_name\" v-model=\"registerform.fixmedins_name\" require=\"true\"\r\n                             :readonly=\"registerflag\"/>\r\n                  </el-col>\r\n                </el-row>\r\n                <el-row>\r\n                  <el-col :span=\"24\">\r\n                    <div v-show=\"!registerflag\"\r\n                         style=\"margin-left: 100px;background: #fffce7;color: #fdae17;font-weight: 500;line-height: 18px;word-break: break-all;padding: 8px 17px\">\r\n                      请填写准确的机构名称全称\r\n                    </div>\r\n                  </el-col>\r\n                </el-row>\r\n                <el-row>\r\n                  <el-col :span=\"24\">\r\n                    <ef-text label=\"申请人\" name=\"username\" v-model=\"registerform.username\" require=\"true\"\r\n                             :readonly=\"registerflag\"/>\r\n                  </el-col>\r\n                </el-row>\r\n                <el-row>\r\n                  <el-col :span=\"24\">\r\n                    <ef-text label=\"联系电话\" name=\"tel\" v-model=\"registerform.tel\" require=\"true\"\r\n                             :readonly=\"registerflag\"/>\r\n                  </el-col>\r\n                </el-row>\r\n                <el-row>\r\n                  <el-col :span=\"24\" style=\"margin-bottom: 5px\">\r\n                    <ef-text label=\"本电脑IP地址\" name=\"ip\" v-model=\"registerform.ip\" readonly=\"true\"/>\r\n                  </el-col>\r\n                </el-row>\r\n                <el-row>\r\n                  <el-col :span=\"24\">\r\n                    <div v-show=\"!registerflag\"\r\n                         style=\"margin-left: 100px;background: #fffce7;color: #fdae17;font-weight: 500;line-height: 18px;word-break: break-all;padding: 8px 17px\">\r\n                      本机IP自动获取，不可更改\r\n                    </div>\r\n                  </el-col>\r\n                </el-row>\r\n                <el-row>\r\n                  <el-col :span=\"24\" style=\"margin-bottom: 5px\">\r\n                    <ef-text label=\"本电脑MAC地址\" name=\"mac\" v-model=\"registerform.mac\" readonly=\"true\"/>\r\n                  </el-col>\r\n                </el-row>\r\n                <el-row>\r\n                  <el-col :span=\"24\">\r\n                    <div v-show=\"!registerflag\"\r\n                         style=\"margin-left: 100px;background: #fffce7;color: #fdae17;font-weight: 500;line-height: 18px;word-break: break-all;padding: 8px 17px\">\r\n                      本机MAC地址自动获取，不可更改\r\n                    </div>\r\n                  </el-col>\r\n                </el-row>\r\n                <div v-show=\"!registerflag\" class=\"more-button\" style=\"justify-content: center;margin-top: 20px\">\r\n                  <el-button v-prevent-re-click style=\"width: 100px;\" icon=\"el-icon-folder-checked\" size=\"mini\" type=\"primary\"\r\n                             @click=\"register()\">提交\r\n                  </el-button>\r\n                </div>\r\n              </el-form>\r\n\r\n              <el-form @submit.native.prevent ref=\"registerform1\" :model=\"registerform1\" label-position=\"right\"\r\n                       label-width=\"100px\" v-show=\"registerform.fix_flag=='0'\">\r\n                <el-row>\r\n                  <el-col :span=\"24\">\r\n                    <ef-text label=\"社会信用编码\" name=\"uscc\" v-model=\"registerform1.uscc\" require=\"true\"\r\n                             :readonly=\"registerflag\"/>\r\n                  </el-col>\r\n                </el-row>\r\n                <el-row>\r\n                  <el-col :span=\"24\">\r\n                    <ef-text label=\"机构名称\" name=\"fixmedins_name\" v-model=\"registerform1.fixmedins_name\" require=\"true\"\r\n                             :readonly=\"registerflag\"/>\r\n                  </el-col>\r\n                </el-row>\r\n                <el-row>\r\n                  <el-col :span=\"24\">\r\n                    <ef-text label=\"申请人\" name=\"username\" v-model=\"registerform1.username\" require=\"true\"\r\n                             :readonly=\"registerflag\"/>\r\n                  </el-col>\r\n                </el-row>\r\n                <el-row>\r\n                  <el-col :span=\"24\">\r\n                    <ef-text label=\"联系电话\" name=\"tel\" v-model=\"registerform1.tel\" require=\"true\"\r\n                             :readonly=\"registerflag\"/>\r\n                  </el-col>\r\n                </el-row>\r\n                <el-row>\r\n                  <el-col :span=\"24\">\r\n                    <ef-text label=\"本电脑IP地址\" name=\"ip\" v-model=\"registerform1.ip\" readonly=\"true\"/>\r\n                  </el-col>\r\n                </el-row>\r\n                <el-row>\r\n                  <el-col :span=\"24\">\r\n                    <ef-text label=\"本电脑MAC地址\" name=\"mac\" v-model=\"registerform1.mac\" readonly=\"true\"/>\r\n                  </el-col>\r\n                </el-row>\r\n                <div v-show=\"!registerflag\" class=\"more-button\" style=\"justify-content: center;margin-top: 20px\">\r\n                  <el-button v-prevent-re-click style=\"width: 100px;\" icon=\"el-icon-folder-checked\" size=\"mini\" type=\"primary\"\r\n                             @click=\"register()\">提交\r\n                  </el-button>\r\n                </div>\r\n              </el-form>\r\n            </base-block>\r\n          </div>\r\n        </el-main>\r\n      </el-container>\r\n    </el-dialog>\r\n\r\n    <el-dialog class=\"register-dialog\" :visible.sync=\"cainfoVisible\" :close-on-click-modal=\"false\" width=\"620px\"\r\n               :before-close=\"handleCainfoClose\" center>\r\n      <div slot=\"title\">\r\n        <div style=\"font-size: 20px\">机构安全码绑定</div>\r\n      </div>\r\n      <el-container style=\"height: 100%\">\r\n        <el-main style=\"height: 100%;overflow: auto;\">\r\n          <div class=\"main-content\">\r\n            <base-block rounded>\r\n              <el-form ref=\"caform\" :model=\"caform\" label-position=\"right\" label-width=\"50px\">\r\n                <el-row>\r\n                  <el-col :span=\"24\" style=\"margin-bottom: 5px\">\r\n                    <div v-show=\"tipflag1\" style=\"text-align: center;background: #fffce7;color: #fdae17;font-weight: 500;line-height: 18px;word-break: break-all;padding: 8px 17px\">\r\n                      定点机构尚未绑定安全码，请立即绑定，否则将无法正常登录并使用系统。&nbsp;&nbsp;&nbsp;&nbsp;\r\n                      <span style=\"font-size:14px;text-decoration:underline\" @click=\"linkAnQuan\">\r\n                        安全码申请\r\n                      </span>\r\n                    </div>\r\n                    <div v-show=\"tipflag2\"\r\n                         style=\"text-align: center;background: #fffce7;color: #fdae17;font-weight: 500;line-height: 18px;word-break: break-all;padding: 8px 17px\">\r\n                      您的原机构安全码（原安全码信息如下框内所示），现无法校验通过，请确认机构安全码是否有变更并重新进行绑定，否则将无法正常登录并使用系统。\r\n                    </div>\r\n                  </el-col>\r\n                </el-row>\r\n                <el-row>\r\n                  <el-col :span=\"24\" style=\"margin-bottom: 5px\">\r\n                    <ef-textarea label=\"安全码\" name=\"cainfo\" v-model=\"caform.cainfo\" require=\"true\" rows=\"5\"/>\r\n                  </el-col>\r\n                </el-row>\r\n                <el-row>\r\n                  <el-col :span=\"24\">\r\n                    <ef-show :show-type=\"showType\" label=\"AK\" name=\"api_access_key\" v-model=\"caform.api_access_key\"/>\r\n                  </el-col>\r\n                </el-row>\r\n                <el-row>\r\n                  <el-col :span=\"24\">\r\n                    <ef-show :show-type=\"showType\" label=\"SK\" name=\"api_secret_key\" v-model=\"caform.api_secret_key\"/>\r\n                  </el-col>\r\n                </el-row>\r\n                <el-row>\r\n                  <el-col :span=\"24\">\r\n                    <div v-show=\"errorflag1\"\r\n                         style=\"text-align: center;background: #fff;color: #ec0b12;font-weight: 500;line-height: 18px;word-break: break-all;padding: 8px 17px\">\r\n                      <i class=\"el-icon-warning\" style=\"margin-right:5px;\"></i>机构安全码校验未通过，请修改并确保安全码的正确性，并再次提交绑定\r\n                    </div>\r\n                  </el-col>\r\n                </el-row>\r\n                <div class=\"more-button\" style=\"justify-content: center;margin-top: 20px\">\r\n                  <el-button v-prevent-re-click style=\"width: 100px;\" icon=\"el-icon-folder-checked\" size=\"mini\" type=\"primary\"\r\n                             @click=\"confirm()\">确认绑定\r\n                  </el-button>\r\n                </div>\r\n              </el-form>\r\n            </base-block>\r\n          </div>\r\n        </el-main>\r\n      </el-container>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n<script>\r\nimport {randomLenNum} from \"@/util/util\";\r\nimport {mapGetters} from \"vuex\";\r\nimport '@/styles/login.scss'\r\nimport {isMobile, isPhone} from \"../../util/validate\";\r\nimport {removeStore, setStore} from \"../../util/store\";\r\nimport ViewsRouter from '@/router/views/index'\r\nimport {resetRouter} from \"@/router/router\";\r\nexport default {\r\n  name: \"loginIndex\",\r\n  data() {\r\n    const validateCode = (rule, value, callback) => {\r\n      if (this.code.value != value) {\r\n        this.loginForm.code = \"\";\r\n        this.refreshCode();\r\n        callback(new Error(\"请输入正确的验证码\"));\r\n      } else {\r\n        callback();\r\n      }\r\n    };\r\n    return {\r\n      showType: ['type2', 'textRight'],\r\n      topTitle: '',\r\n      dialogVisible: false,\r\n      cainfoVisible: false,\r\n      reIp: \"\",//注册提示IP\r\n      reMac: \"\",//注册提示Mac\r\n      loginForm: {\r\n        username: \"\",\r\n        password: \"\",\r\n        code: \"\",\r\n        redomStr: \"\",\r\n        ipAddr: \"\",\r\n        macAddr: \"\",\r\n        fixmedins_id: \"\",\r\n        fixmedins_name: \"\",\r\n      },\r\n      code: {\r\n        src: \"\",\r\n        value: \"\",\r\n        len: 4,\r\n        type: \"text\"\r\n      },\r\n\r\n      loginRules: {\r\n        username: [\r\n          {required: true, message: \"请输入用户名\", trigger: \"blur\"}\r\n        ],\r\n        password: [\r\n          {required: true, message: \"请输入密码\", trigger: \"blur\"},\r\n          // {min: 6, message: \"密码长度最少为6位\", trigger: \"blur\"}\r\n        ],\r\n        code: [\r\n          {required: true, message: \"请输入验证码\", trigger: \"blur\"},\r\n          {min: 4, max: 4, message: \"验证码长度为4位\", trigger: \"blur\"},\r\n          {required: true, trigger: \"blur\", validator: validateCode}\r\n        ]\r\n      },\r\n      statusjson: {\r\n        '0': '审核中',\r\n        '2': '审核通过',\r\n        '3': '审核未通过'\r\n      },\r\n\r\n      passwordType: \"password\",\r\n      registerflag: false,\r\n      registerform: {\r\n        registerid: '',\r\n        fixmedins_code: '',\r\n        uscc: '',\r\n        fixmedins_name: '',\r\n        fix_flag: '1',\r\n        username: '',\r\n        tel: '',\r\n        ip: '',\r\n        mac: '',\r\n      },\r\n      registerform1: {\r\n        registerid: '',\r\n        fixmedins_code: '',\r\n        uscc: '',\r\n        fixmedins_name: '',\r\n        fix_flag: '1',\r\n        username: '',\r\n        tel: '',\r\n        ip: '',\r\n        mac: '',\r\n      },\r\n      caform: {\r\n        cainfo: '',\r\n        api_access_key: '',\r\n        api_secret_key: ''\r\n      },\r\n      tipflag1: false,\r\n      tipflag2: false,\r\n      errorflag1: false,\r\n      status: '',\r\n      remark: '',\r\n      examinetime: '',\r\n      isregister: false,\r\n      path: '',\r\n      isAdmin: false,//是否管理员-可选机构\r\n      fixmedinsList: [],//机构字典\r\n    };\r\n  },\r\n  created() {\r\n    removeStore({name: 'LoginInfo'})\r\n    this.refreshCode();\r\n    //获取IP地址、MAC地址\r\n    this.getLocalIP();\r\n  },\r\n  mounted() {\r\n  },\r\n  computed: {\r\n    ...mapGetters([\"tagWel\", \"website\", \"userInfo\",])\r\n  },\r\n  props: [],\r\n  methods: {\r\n    linkAnQuan() {\r\n      window.open(\"http://10.58.10.3:32001/#/signup\", 'anquanregister', 'height=700,width=1200')\r\n      // window.location.href = \"http://10.58.10.3:32001/#/signup\"\r\n    },\r\n\r\n    register() {\r\n      let that = this;\r\n      if (that.registerform.fix_flag == '1') { //定点\r\n        that.$refs['registerform'].validate((valid) => {\r\n          if (valid) {\r\n            if (that.registerform.fixmedins_code.trim().length < 12) {\r\n              that.$eframe.alertError(\"请填写12位国家医药机构编码（提示：第1位是字母，后11位是数字）\");\r\n              return;\r\n            }\r\n            if (!(isMobile(that.registerform.tel) || isPhone(that.registerform.tel))) {\r\n              that.$eframe.alertError(\"请输入正确的联系电话，方便工作人员联系\");\r\n              return;\r\n            }\r\n            that.registerform1.uscc = ''\r\n            that.save();\r\n          } else {\r\n            that.$eframe.alertError(\"表单填写不完整\");\r\n            return false;\r\n          }\r\n        });\r\n      } else {\r\n        that.$refs['registerform1'].validate((valid) => {\r\n          if (valid) {\r\n            if (!(isMobile(that.registerform1.tel) || isPhone(that.registerform1.tel))) {\r\n              that.$eframe.alertError(\"请输入正确的联系电话，方便工作人员联系\");\r\n              return;\r\n            }\r\n            that.registerform1.fixmedins_code = ''\r\n            that.registerform = that.registerform1;\r\n            that.save();\r\n          } else {\r\n            that.$eframe.alertError(\"表单填写不完整\");\r\n            return false;\r\n          }\r\n        });\r\n      }\r\n    },\r\n    save() {\r\n      let that = this;\r\n      let loc_form = {\r\n        registerid: that.registerform.registerid,\r\n        fixmedins_code: that.registerform.fixmedins_code,\r\n        uscc: that.registerform.uscc,\r\n        fixmedins_name: that.registerform.fixmedins_name,\r\n        fix_flag: that.registerform.fix_flag,\r\n        username: that.registerform.username,\r\n        tel: that.registerform.tel,\r\n        ip: that.registerform.ip,\r\n        mac: that.registerform.mac,\r\n        examinestatus: '0'\r\n      };\r\n      let succFun = function (data) {\r\n        that.$eframe.alertMessage(\"电脑入驻平台申请成功，请等待审核~~~审核通过后即可使用账号密码进行登录\");\r\n        that.dialogVisible = false\r\n      };\r\n      let failFun = function (data) {\r\n\r\n      };\r\n      this.$eframe.submitTargetForm({\r\n        url: '/userloginmgmt/login.action',\r\n        form: loc_form,\r\n        actionFunName: \"saveRegister\",\r\n        succFun: succFun,\r\n        failFun: failFun,\r\n      });\r\n    },\r\n    substring(data, start, end) {\r\n      if (this.$eframe.isNotNull(data)) {\r\n        return data.substring(start, end)\r\n      }\r\n    },\r\n    loadRegisterInfo() {\r\n      let that = this\r\n      let loc_form = {\r\n        ip: that.registerform.ip,\r\n        mac: that.registerform.mac\r\n      }\r\n      //判断审核状态，0-待审核，2-审核通过，3-审核不通过\r\n      let succFun = function (data) {\r\n        if (data.registerid != null) {\r\n          that.registerform.fixmedins_code = data.fixmedins_code\r\n          that.registerform.uscc = data.uscc\r\n          that.registerform.fixmedins_name = data.fixmedins_name\r\n          that.registerform.fix_flag = data.fix_flag\r\n          that.registerform.username = data.username\r\n          that.registerform.tel = data.tel\r\n          that.registerform.ip = data.ip\r\n          that.registerform.mac = data.mac\r\n          that.examinestatus = data.examinestatus\r\n          if (that.examinestatus == '0') {\r\n            that.registerflag = false\r\n            that.registerform.registerid = data.registerid\r\n          } else if (that.examinestatus == '2') {\r\n            that.registerflag = true\r\n          } else if (that.examinestatus == '3') {\r\n            that.registerflag = false\r\n          }\r\n          // that.registerflag = true\r\n          that.status = data.examinestatus\r\n          that.remark = data.remark\r\n          that.examinetime = data.examinetime\r\n          that.registerform1 = that.registerform\r\n        }\r\n      };\r\n      let failFun = function (data) {\r\n\r\n      };\r\n      this.$eframe.submitTargetForm({\r\n        url: '/userloginmgmt/login.action',\r\n        form: loc_form,\r\n        actionFunName: \"loadRegister\",\r\n        succFun: succFun,\r\n        failFun: failFun,\r\n      });\r\n    },\r\n\r\n    showInfo() {\r\n      this.dialogVisible = true;\r\n      this.loadRegisterInfo();\r\n    },\r\n    handleClose() {\r\n      this.dialogVisible = false\r\n    },\r\n    // 获取IP地址\r\n    getLocalIP() {\r\n      let that = this;\r\n      let callBackFun = function (data) {\r\n        console.log(\"IP：\" + JSON.stringify(data));\r\n\r\n        let list = [];\r\n        for (let devName in data) {\r\n          let iface = data[devName];\r\n          for (let i = 0; i < iface.length; i++) {\r\n            let alias = iface[i];\r\n            if (alias.family === 'IPv4' && alias.address !== '127.0.0.1' && !alias.internal) {\r\n              //TODO 获取第一条IP地址\r\n              if (that.isNull(that.registerform.ip)) {\r\n\r\n                that.registerform.ip = alias.address;//IP\r\n                that.registerform.mac = alias.mac;//MAC\r\n                that.registerform1 = that.registerform\r\n              }\r\n\r\n              let item = {ip_addr: alias.address, mac_adrr: alias.mac};\r\n              list.push(item);\r\n              // if (that.getFixmedinsByIp()) { //获取机构\r\n              //   break;\r\n              // }\r\n            }\r\n          }\r\n        }\r\n        that.getFixmedinOfMacs(list);\r\n        // if(that.isNull(that.topTitle)){\r\n        //   that.topTitle='简易HIS平台';\r\n        // }\r\n      }\r\n      this.$eframe.callSysFun({\r\n        funName: 'getLocalAddress',\r\n        params: {},\r\n        callBackFun: callBackFun,\r\n      });\r\n    },\r\n    isNull(data) {\r\n      return this.$eframe.isNull(data);\r\n    },\r\n    //根据IP+MAC获取机构信息\r\n    getFixmedinsByIp() {\r\n      let that = this;\r\n      let localForm = {\r\n        ipAddr: this.loginForm.ipAddr,\r\n        macAddr: this.loginForm.macAddr,\r\n      };\r\n      let succFun = function (data) {\r\n        if (data != null && !that.isNull(data.fixmedins_id)) {\r\n          that.topTitle = data.fixmedins_name;//机构名称\r\n          that.loginForm.fixmedins_id = data.fixmedins_id;//机构ID\r\n          that.loginForm.fixmedins_name = data.fixmedins_name;//机构名称\r\n          // if(data.fixmedins_type===\"2\"){\r\n          //   that.website.title=\"云药店\";\r\n          // }else{\r\n          //   that.website.title=\"云诊所\";\r\n          // }\r\n\r\n\r\n          // if(isNull(that.loginForm.fixmedins_id)){\r\n          // if(that.loginForm.fixmedins_id){\r\n          //   that.loadRegisterInfo();  //获取申请信息\r\n          // }\r\n          return true;\r\n        } else {\r\n          return false;\r\n        }\r\n      };\r\n      let failFun = function (data) {\r\n        return false;\r\n      };\r\n      this.$eframe.submitTargetForm({\r\n        url: '/userloginmgmt/login.action',\r\n        form: localForm,\r\n        actionFunName: \"getFixmedinsByIP\",\r\n        succFun: succFun,\r\n        failFun: failFun,\r\n      });\r\n    },\r\n    //根据IP+MAC获取机构信息\r\n    getFixmedinOfMacs(list) {\r\n      let that = this;\r\n      let exeVersion = '';\r\n      if (window.getExeVersion) {//取版本号\r\n        exeVersion = window.getExeVersion();\r\n      }\r\n      let localForm = {\r\n        fixmedinsPcBDOList: list,\r\n        exeVersion:exeVersion,\r\n      };\r\n      let succFun = function (data) {\r\n        if (data != null && that.$eframe.isNotNull(data.fixmedins_id)) {\r\n          that.topTitle = data.fixmedins_name;//机构名称\r\n          that.loginForm.fixmedins_id = data.fixmedins_id;//机构ID\r\n          that.loginForm.fixmedins_code = data.fixmedins_code;//机构编码\r\n          that.loginForm.fixmedins_name = data.fixmedins_name;//机构名称\r\n          that.loginForm.fix_blng_admdvs = data.fix_blng_admdvs;\r\n          that.loginForm.ipAddr = data.ip_addr;//IP\r\n          that.loginForm.macAddr = data.mac_adrr;//MAC\r\n          that.caform.cainfo = data.cainfo;//安全码\r\n          let loginInfo = {\r\n            fixmedins_id: data.fixmedins_id,//机构ID\r\n            ipAddr: data.ip_addr,//IP\r\n            macAddr: data.mac_adrr,//MAC\r\n          }\r\n          setStore({name: 'LoginInfo', content: loginInfo})\r\n\r\n          //判断安全码\r\n          if (data.fix_flag == '1' && that.isNull(data.cainfo)) {\r\n            that.cainfoVisible = true;\r\n            that.tipflag1 = true;\r\n            that.errorflag1 = false;\r\n            that.caform.api_access_key = data.api_access_key;\r\n            that.caform.api_secret_key = data.api_secret_key;\r\n          }\r\n        } else { //没有机构\r\n          let loginInfo = {\r\n            ipAddr: that.registerform.ip,//IP\r\n            macAddr: that.registerform.mac,//MAC\r\n          }\r\n          setStore({name: 'LoginInfo', content: loginInfo})\r\n        }\r\n      };\r\n      let failFun = function (data) {\r\n      };\r\n      this.$eframe.submitTargetForm({\r\n        url: '/userloginmgmt/login.action',\r\n        form: localForm,\r\n        actionFunName: \"getFixmedinOfMacs\",\r\n        succFun: succFun,\r\n        failFun: failFun,\r\n      });\r\n    },\r\n\r\n    refreshCode() {\r\n      this.loginForm.redomStr = randomLenNum(this.code.len, true);\r\n      this.code.type == \"text\" ? (this.code.value = randomLenNum(this.code.len)) : (this.code.src = `${this.codeUrl}/${this.loginForm.redomStr}`);\r\n      // this.loginForm.code = this.code.value;\r\n    },\r\n    showPassword() {\r\n      this.passwordType == \"\" ? (this.passwordType = \"password\") : (this.passwordType = \"\");\r\n    },\r\n    handleLogin() {\r\n      let that = this;\r\n      this.$refs.loginForm.validate(valid => {\r\n        if (valid) {\r\n          // if (that.isAdmin && that.isNull(that.loginForm.fixmedins_id)) {\r\n          //   that.$eframe.alertError(\"管理员账号，请选择本次登录机构。\");\r\n          //   return;\r\n          // }\r\n          // if (that.isNull(that.loginForm.fixmedins_id) && that.loginForm.username != 'U001' && that.loginForm.username != 'U002') {\r\n          //   that.$eframe.alertError(\"本设备未入驻平台，请点击下方按钮进行注册。\");\r\n          //   return;\r\n          // }\r\n          console.log(\"test\");\r\n          that.$store.dispatch(\"LoginByUsername\", that.loginForm).then((data) => {\r\n            that.path = that.tagWel.value;\r\n            that.$router.$avueRouter.formatviewsRoutes([...ViewsRouter],true)\r\n\r\n            that.$router.push({\r\n              path: '/wel/index',\r\n              query:{\r\n                topId:that.tagWel.topId\r\n              }\r\n            });\r\n          });\r\n        }\r\n      });\r\n    },\r\n    handleCainfoClose() {\r\n      this.cainfoVisible = false;\r\n    },\r\n    //提交安全码\r\n    confirm() {\r\n      let that = this;\r\n      that.$refs['caform'].validate((valid) => {\r\n        if (valid) {\r\n          if (that.caform.cainfo.length < 100) {\r\n            that.$eframe.alertError(\"安全码不正确\");\r\n            return;\r\n          }\r\n          let temp = {\r\n            fixmedins_id: that.loginForm.fixmedins_id,\r\n            fixmedins_code: that.loginForm.fixmedins_code,\r\n            fixmedins_name: that.loginForm.fixmedins_name,\r\n            ip_addr: that.loginForm.ipAddr,\r\n            mac_adrr: that.loginForm.macAddr,\r\n            fix_blng_admdvs: that.loginForm.fix_blng_admdvs,\r\n            uact: that.loginForm.username,\r\n            cainfo: that.caform.cainfo.trim(),\r\n            api_access_key: that.caform.api_access_key,\r\n            api_secret_key: that.caform.api_secret_key,\r\n          };\r\n\r\n          let callbackFun = function (data) {\r\n            that.cainfoVisible = false;\r\n            that.loginForm.cainfo = data.cainfo;\r\n          };\r\n          this.$eframe.submitTargetForm({\r\n            url: '/userloginmgmt/login.action',\r\n            form: temp,\r\n            actionFunName: \"checkCaInfo\",\r\n            succFun: callbackFun,\r\n            failFun: null\r\n          });\r\n        } else {\r\n          that.$eframe.alertError(\"表单填写不完整\");\r\n          return false;\r\n        }\r\n      });\r\n    },\r\n\r\n    checkUserName() {\r\n      let that = this;\r\n      if (that.isNull(that.topTitle) && that.loginForm.username === 'Admin_2022.') {//固定账号可选择机构\r\n        if (that.$eframe.isListEmpty(that.fixmedinsList)) {\r\n          //获取机构LIST\r\n          let succFun = function (data) {\r\n            that.fixmedinsList = data;\r\n          };\r\n          let failFun = function (data) {\r\n          };\r\n          this.$eframe.submitTargetForm({\r\n            url: '/userloginmgmt/login.action',\r\n            form: {},\r\n            actionFunName: \"loadFixmedinsDic\",\r\n            succFun: succFun,\r\n            failFun: failFun,\r\n          });\r\n          that.isAdmin = true;\r\n        }\r\n      } else {\r\n        that.isAdmin = false;\r\n      }\r\n    },\r\n    //机构改变\r\n    changeFixmedins() {\r\n      if (this.loginForm.fixmedins_id) {\r\n        for (let i=0,len=this.fixmedinsList.length;i<len;i++) {\r\n          let item = this.fixmedinsList[i];\r\n          if (item.code === this.loginForm.fixmedins_id) {\r\n            this.loginForm.fixmedins_name = item.name;\r\n            this.loginForm.macAddr = item.exp;\r\n            if (this.isNull(item.exp1)) {\r\n              this.loginForm.ipAddr = this.registerform.ip;\r\n            } else {\r\n              this.loginForm.ipAddr = item.exp1;\r\n            }\r\n            let loginInfo = {\r\n              fixmedins_id: this.loginForm.fixmedins_id,//机构ID\r\n              ipAddr: this.loginForm.ipAddr,//IP\r\n              macAddr: this.loginForm.macAddr,//MAC\r\n            }\r\n            setStore({name: 'LoginInfo', content: loginInfo})\r\n            break;\r\n          }\r\n        }\r\n      } else {\r\n        this.loginForm.fixmedins_name = \"\";\r\n        this.loginForm.macAddr = \"\";\r\n        this.loginForm.ipAddr = \"\";\r\n        removeStore({name: 'LoginInfo'});\r\n      }\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n::v-deep .register-dialog .el-dialog__header {\r\n  height: 66px;\r\n  padding: 10px 24px;\r\n}\r\n\r\n::v-deep .el-select {\r\n  height: 100%;\r\n\r\n  .el-input {\r\n    height: 100%;\r\n\r\n    .el-input__inner {\r\n      height: 100%;\r\n      font-size: 16px;\r\n    }\r\n  }\r\n}\r\n\r\n</style>"]}]}